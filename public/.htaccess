# Enable static HTML serving before SPA fallback

# Serve static HTML files directly
RewriteEngine On

# Serve pre-rendered HTML files
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/?$ /$1/index.html [L]

# Diagnostic endpoints
RewriteRule ^__diagnostics/html$ /__diagnostics/html.txt [L]
RewriteRule ^__diagnostics/seo$ /__diagnostics/seo.json [L]
RewriteRule ^__diagnostics/build$ /__diagnostics/build-verification.json [L]

# SPA fallback for dynamic routes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]

# Cache static assets
<FilesMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg)$">
  ExpiresActive On
  ExpiresDefault "access plus 1 month"
</FilesMatch>